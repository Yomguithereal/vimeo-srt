/*
 *  Project: Vimeo Srt Plugin
 *  Description: A simplistic jQuery plugin to display srt subtitles with vimeo
 *  embedded videos.
 *  Author: PLIQUE Guillaume (Yomguithereal)
 *  Dependancies : -- Froogaloop API --
 *  License: MIT
 */
(function(d,a,f,h,b){var i="vimeoSrt",c={srt:"sample.srt"};function j(m,l){this.element=m;this.options=d.extend({},c,l);this._defaults=c;this._name="vimeoSrt";
this._srt=[];this._currentSecond=0;this._$iframe=false;this._$subtitles=false;this._spaces=new RegExp("\n\n|\r\n\r\n|\r\r","g");this._carriages=new RegExp("\n|\r\n|\r","g");
this.init();}function e(n){var m=n.split(",");var l=parseInt(m[1]);var p=m[0].split(":");var o=(parseInt(p[0])*60*60)+(parseInt(p[1])*60)+(parseInt(p[2]));
return parseFloat(o+"."+l);}function g(m){var l=m.split(".")[1];m=parseInt(m);return toTime(m)+","+l;}function k(n,m){var l=n.map(function(o){return[o,Math.abs(o.seconds_begin-m)];
});return l.reduce(function(o,p){return(o[1]<p[1])?o:p;},[-1,999])[0];}j.prototype={init:function(){var l=this;this._$iframe=d(this.element);this._$iframe.load(m);
function m(){d.get(l.options.srt,function(o){l._$iframe.after('<div id="'+l.element.getAttribute("id")+'_subtitles">&nbsp;</div>');l._$subtitles=d("#"+l.element.getAttribute("id")+"_subtitles");
l.parseSrt(o);n();});}function n(){var p=a(l.element.getAttribute("id"));p.addEvent("ready",function(){p.addEvent("playProgress",o);});function o(r,s){l._currentSecond=parseFloat(r.seconds);
var q=l.findSuitableStep();if(q){l._$subtitles.html(q.text);}}}},parseSrt:function(m){var l=this;m.split(this._spaces).forEach(function(o){var n=o.split(l._carriages).filter(function(p){return d.trim(p)!="";
});if(n[1]!==b){l._srt.push({seconds_begin:e(n[1].split(" --> ")[0]),seconds_end:e(n[1].split(" --> ")[1]),time:n[1],text:n.slice(2).join("<br>")});}});
},findSuitableStep:function(){var l=k(this._srt,this._currentSecond);return l.seconds_begin>this._currentSecond?false:l;}};d.fn[i]=function(l){return this.each(function(){if(!d.data(this,"plugin_"+i)){d.data(this,"plugin_"+i,new j(this,l));
}});};})(jQuery,Froogaloop,window,document);